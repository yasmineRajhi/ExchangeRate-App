<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exchange Rate</title>
    <link rel="stylesheet" href="ExchangeRate.css">
    <script src="SetDateToToday.js" defer></script>
    <!-- <script src="ExchangeRate.js" defer></script> -->
</head>
<body>
    <div class="wrapper">
        <header>Currency Converter</header>
        <form action="#">
            <p>Enter Amount (EUR) : </p>
            <input type="text" name="input" id="input" placeholder="please enter your value" autocomplete="off">
            <p>Choose the date : </p>
            <input type="date" name="date" id="datefield" min="2000-01-01" onclick="dateUpdate()">
            <br>
            <select name="currencies" id="currencies">
                <option value="SELECT THE CURRENCY"  selected>SELECT THE CURRENCY</option>
                <option value="TND">TND</option>
                <option value="USD">USD</option>
                <option value="EGP">EGP</option>
            </select>
            <br>
            <div class="result">
                
            </div>
            <button>Get Exchnage Rate</button>
        </form>
    </div>
    <div class="small">
        <small>Created by Yasmine Rajhi</small>
    </div>
</body>
<script type="module">
    const form = document.querySelector("form");
let date = document.querySelector("input[type=date]").value;
console.log(date);
let url = `http://api.exchangeratesapi.io/v1/${date}?access_key=876fddb6aa3434033523b5285d1992f5&format=1`;
//dateUpdate(url);
let rates
form.addEventListener("submit", (e) =>{
    e.preventDefault();
})
fetch(url).then(response => response.json()).then(data => {
    rates = data.rates;
}).catch(error => {
    console.log("error :",error)
})

document.querySelector("button").onclick = () => {
    let value = document.querySelector("input[type=text]").value;
    let exchangeRate = document.querySelector("select").value;
    let totalExchange = value * rates[exchangeRate]
    document.querySelector(".result").innerText = `${value} in EUR is ${totalExchange} en ${exchangeRate}`
}

function dateUpdate(){
    let dateUpdate = document.querySelector("input[type=date]").value;
    date = dateUpdate;
    url = `http://api.exchangeratesapi.io/v1/${date}?access_key=876fddb6aa3434033523b5285d1992f5&format=1`
    console.log(date);
}
</script>
</html>